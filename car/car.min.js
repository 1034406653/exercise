/********键盘弹出控制开始***********/
window.onload = function() {
  var oHtml = document.getElementsByTagName("html")[0];
  var scWid = document.documentElement.offsetWidth || document.body.offsetWidth;
  var initWid = 640;
  oHtml.style.fontSize = 100 * scWid / initWid + "px"
};

function chePaiZuJian(boxId, chepaihao) {
  var box = $("#" + boxId);
  box.html(" <ul class='chepai-list'><li>省</li><li></li><li></li><li></li><li></li><li></li><li></li><div class='new-energy-btn'><span>+</span><span>能源</span></div></ul><div class='close-jianpan'><div>完成</div></div><div class='jianpan-hanzi'><ul><li>京</li><li>津</li><li>渝</li><li>沪</li><li>冀</li><li>晋</li><li>辽</li><li>吉</li><li>黑</li><li>苏</li></ul><ul><li>浙</li><li>皖</li><li>闽</li><li>赣</li><li>鲁</li><li>豫</li><li>鄂</li><li>湘</li><li>粤</li><li>琼</li></ul><ul><li>川</li><li>贵</li><li>云</li><li>陕</li><li>甘</li><li>青</li><li>蒙</li><li>桂</li><li>宁</li><li>新</li></ul><ul><div class='abc'>ABC</div><li>藏</li><li>使</li><li>领</li><li>警</li><li>学</li><li>港</li><li>奥</li><div class='del'>删</div></ul></div><div class='jianpan-shuzi'><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>0</li></ul><ul><li>Q</li><li>W</li><li>E</li><li>R</li><li>T</li><li>Y</li><li>U</li><li>I</li><li>O</li><li>P</li></ul><ul><li style='margin-left: 6%;'>A</li><li>S</li><li>D</li><li>F</li><li>G</li><li>H</li><li>J</li><li>K</li><li>L</li></ul><ul><div class='back'>返回</div><li>Z</li><li>X</li><li>C</li><li>V</li><li>B</li><li>N</li><li>M</li><div class='del'>删除</div></ul></div>");
  var chepaiList = box.find(".chepai-list");
  var chepaiListLi = box.find(".chepai-list").find("li");
  var jianpanHanzi = box.find(".jianpan-hanzi");
  var jianpanShuzi = box.find(".jianpan-shuzi");
  var jianpanHanziLi = jianpanHanzi.find("li");
  var jianpanShuziLi = jianpanShuzi.find("li");
  var newEnergy = box.find(".chepai-list").find(".new-energy");
  var newEnergyBtn = box.find(".chepai-list").find(".new-energy-btn");
  var closeBtn = box.find(".close-jianpan");
  box.click(function(event) {
    if(event.stopPropagation) {
      event.stopPropagation()
    } else if(window.event) {
      window.event.cancelBubble = true
    }
  });
  $("body").click(function() {
    closeBtn.hide();
    jianpanHanzi.hide();
    jianpanShuzi.hide()
  });
  newEnergyBtn.click(function() {
    $(this).hide();
    chepaiList.append("<li class='new-energy'></li>");
    newEnergy = box.find(".chepai-list").find(".new-energy");
    chepaiListLi = box.find(".chepai-list").find("li")
  });
  closeBtn.find("div").click(function() {
    var chepaiListLi = box.find(".chepai-list").find("li");
    jianpanHanzi.hide();
    jianpanShuzi.hide();
    chepaiListLi.each(function(ind, val) {
      $(this).removeClass("active")
    });
    closeBtn.hide()
  });
  chepaiListLi.eq(0).click(function() {
    chepaiListLi = box.find(".chepai-list").find("li");
    closeBtn.show();
    jianpanHanzi.show();
    jianpanShuzi.hide();
    chepaiListLi.each(function(ind, val) {
      $(this).removeClass("active")
    });
    if(jianpanHanzi.length > 0) {
      chepaiListLi.eq(0).addClass("active")
    }
  });
  chepaiListLi.each(function(ind, val) {
    if(ind != 0) {
      $(this).click(function() {
        closeBtn.show();
        box.find(".chepai-list").find(".new-energy").removeClass("active");
        jianpanShuzi.show();
        jianpanHanzi.hide();
        chepaiListLi.each(function() {
          $(this).removeClass("active")
        });
        $(this).addClass("active")
      })
    }
  });
  chepaiList.on("click", ".new-energy", function() {
    closeBtn.show();
    chepaiListLi.each(function() {
      $(this).removeClass("active")
    });
    jianpanShuzi.show();
    jianpanHanzi.hide();
    newEnergy.addClass("active")
  });
  jianpanHanziLi.click(function() {
    chepaiListLi = box.find(".chepai-list").find("li");
    chepaiListLi.eq(0).text($(this).text());
    jianpanHanzi.hide();
    jianpanShuzi.show();
    chepaiListLi.each(function(ind, val) {
      $(this).removeClass("active")
    });
    chepaiListLi.each(function(ind, val) {
      if(ind != 0 && $(this).text() == "") {
        $(this).addClass("active");
        return false
      }
    })
  });
  jianpanHanzi.find(".abc").click(function() {
    jianpanShuzi.show();
    jianpanHanzi.hide();
    if(jianpanShuzi.length > 0) {
      chepaiListLi.each(function() {
        $(this).removeClass("active")
      });
      chepaiListLi.each(function(ind, val) {
        if(ind != 0 && $(this).text() == "") {
          $(this).addClass("active");
          return false
        }
      })
    }
  });
  jianpanShuzi.find(".back").click(function() {
    jianpanHanzi.show();
    jianpanShuzi.hide();
    chepaiListLi.each(function() {
      $(this).removeClass("active")
    });
    chepaiListLi.eq(0).addClass("active")
  });
  jianpanShuziLi.click(function() {
    chepaiListLi = box.find(".chepai-list").find("li");
    var thisText = $(this).text();
    chepaiListLi.each(function(ind, val) {
      if(ind != 0 && $(this).hasClass("active") && ind < chepaiListLi.length - 1) {
        $(this).text(thisText);
        chepaiListLi.each(function(ind, val) {
          $(this).removeClass("active")
        });
        chepaiListLi.eq(ind + 1).addClass("active");
        return false
      } else if(ind == chepaiListLi.length - 1 && $(this).hasClass("active")) {
        $(this).text(thisText)
      }
    })
  });
  jianpanShuzi.find(".del").click(function() {
    var newEnergy = box.find(".chepai-list").find(".new-energy");
    if(newEnergy.hasClass("active")) {
      newEnergy.remove();
      newEnergyBtn.show();
      chepaiListLi.eq(6).addClass("active")
    } else {
      for(var j = 6; j > 1; j -= 1) {
        if(chepaiListLi.eq(j).hasClass("active")) {
          chepaiListLi.eq(j).text("");
          for(var i = 0; i <= 6; i += 1) {
            chepaiListLi.eq(i).removeClass("active")
          };
          chepaiListLi.eq(j - 1).addClass("active");
          break
        } else if(chepaiListLi.eq(1).hasClass("active")) {
          chepaiListLi.eq(1).text("");
          chepaiListLi.eq(1).removeClass("active");
          chepaiListLi.eq(0).addClass("active");
          jianpanHanzi.show();
          jianpanShuzi.hide()
        }
      }
    }
  });
  jianpanHanzi.find(".del").click(function() {
    chepaiListLi.eq(0).text("")
  });
  jianpanHanziLi.on("touchstart", function() {
    $(this).addClass("activeLi")
  });
  jianpanHanziLi.on("touchend", function() {
    $(this).removeClass("activeLi")
  });
  jianpanHanzi.find("div").on("touchstart", function() {
    $(this).addClass("activeDiv")
  });
  jianpanHanzi.find("div").on("touchend", function() {
    $(this).removeClass("activeDiv")
  });
  jianpanShuziLi.on("touchstart", function() {
    $(this).addClass("activeLi")
  });
  jianpanShuziLi.on("touchend", function() {
    $(this).removeClass("activeLi")
  });
  jianpanShuzi.find("div").on("touchstart", function() {
    $(this).addClass("activeDiv")
  });
  jianpanShuzi.find("div").on("touchend", function() {
    $(this).removeClass("activeDiv")
  })
}
var chepaihao = function(boxID) {
  var chepaihaoVal = "";
  $("#" + boxID).find(".chepai-list").find("li").each(function(ind, val) {
    chepaihaoVal += $(this).text()
  });
  return chepaihaoVal
};